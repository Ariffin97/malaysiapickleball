<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>2025 Tournament Calendar - Malaysia Pickleball Association</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Arial', sans-serif;
      line-height: 1.4;
      color: #333;
      background: white;
    }

    .pdf-container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
    }

    .header {
      text-align: center;
      margin-bottom: 30px;
      border-bottom: 3px solid #667eea;
      padding-bottom: 20px;
    }

    .header h1 {
      font-size: 28px;
      color: #667eea;
      margin-bottom: 8px;
      font-weight: bold;
    }

    .header p {
      font-size: 14px;
      color: #666;
      margin-bottom: 10px;
    }

    .stats {
      display: flex;
      justify-content: center;
      gap: 40px;
      margin-top: 15px;
    }

    .stat-item {
      text-align: center;
    }

    .stat-number {
      font-size: 20px;
      font-weight: bold;
      color: #667eea;
    }

    .stat-label {
      font-size: 12px;
      color: #666;
      margin-top: 2px;
    }

    .legend {
      margin-bottom: 25px;
      background: #f8f9fa;
      padding: 15px;
      border-radius: 8px;
      border: 1px solid #e9ecef;
    }

    .legend h3 {
      font-size: 16px;
      margin-bottom: 12px;
      color: #333;
    }

    .legend-items {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 10px;
    }

    .legend-item {
      display: flex;
      align-items: center;
      font-size: 12px;
    }

    .legend-color {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      margin-right: 8px;
      flex-shrink: 0;
    }

    .legend-color.green { background-color: #10b981; }
    .legend-color.red { background-color: #ef4444; }
    .legend-color.blue { background-color: #3b82f6; }
    .legend-color.purple { background-color: #8b5cf6; }
    .legend-color.orange { background-color: #f97316; }
    .legend-color.yellow { background-color: #f59e0b; }

    .calendar-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 11px;
      background: white;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    .calendar-table th,
    .calendar-table td {
      border: 1px solid #d1d5db;
      text-align: center;
      vertical-align: middle;
    }

    .calendar-table th {
      background: #f3f4f6;
      font-weight: bold;
      color: #374151;
    }

    .month-header {
      background: #667eea !important;
      color: white !important;
      padding: 8px 4px;
      font-size: 10px;
    }

    .quarter-header {
      background: #e5e7eb !important;
      color: #6b7280 !important;
      padding: 4px 2px;
      font-size: 9px;
    }

    .tournament-name {
      text-align: left !important;
      padding: 8px 12px;
      font-weight: bold;
      background: #f9fafb;
      max-width: 250px;
      word-wrap: break-word;
      overflow-wrap: break-word;
      hyphens: auto;
    }

    .calendar-cell {
      width: 20px;
      height: 30px;
      padding: 2px;
      position: relative;
    }

    .tournament-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      margin: 0 auto;
    }

    .filled-green .tournament-dot { background-color: #10b981; }
    .filled-red .tournament-dot { background-color: #ef4444; }
    .filled-blue .tournament-dot { background-color: #3b82f6; }
    .filled-purple .tournament-dot { background-color: #8b5cf6; }
    .filled-orange .tournament-dot { background-color: #f97316; }
    .filled-yellow .tournament-dot { background-color: #f59e0b; }

    .tournament-list {
      margin-top: 30px;
      page-break-inside: avoid;
    }

    .tournament-list h3 {
      font-size: 18px;
      margin-bottom: 15px;
      color: #667eea;
      border-bottom: 2px solid #e5e7eb;
      padding-bottom: 5px;
    }

    .tournament-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px 0;
      border-bottom: 1px solid #f1f3f4;
    }

    .tournament-info {
      flex: 1;
    }

    .tournament-title {
      font-weight: bold;
      font-size: 14px;
      margin-bottom: 2px;
    }

    .tournament-type {
      font-size: 11px;
      color: #666;
      text-transform: capitalize;
    }

    .tournament-dates {
      font-size: 12px;
      color: #333;
      text-align: right;
    }

    .footer {
      margin-top: 30px;
      text-align: center;
      font-size: 10px;
      color: #666;
      border-top: 1px solid #e5e7eb;
      padding-top: 15px;
    }

    /* Print-friendly button for browser printing */
    .print-btn {
      position: fixed;
      top: 20px;
      right: 20px;
      background: #667eea;
      color: white;
      padding: 12px 24px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: bold;
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
      z-index: 1000;
    }
    
    .print-btn:hover {
      background: #5a6fd8;
    }
    
    .print-instructions {
      background: #f0f9ff;
      border: 2px solid #0ea5e9;
      border-radius: 8px;
      padding: 16px;
      margin: 20px 0;
      text-align: center;
    }
    
    .print-instructions h3 {
      color: #0369a1;
      margin-bottom: 8px;
    }
    
    .print-instructions p {
      color: #075985;
      margin: 4px 0;
    }

    @media print {
      body { 
        -webkit-print-color-adjust: exact;
        print-color-adjust: exact;
      }
      
      .pdf-container {
        padding: 10px;
      }
      
      .header h1 {
        font-size: 24px;
      }
      
      .calendar-table {
        font-size: 10px;
      }
      
      .print-btn,
      .print-instructions {
        display: none !important;
      }
    }
  </style>
</head>
<body>
  <!-- Print Button (only visible when not printing) -->
  <button class="print-btn" onclick="window.print()">üñ®Ô∏è Print to PDF</button>
  
  <div class="pdf-container">
    <!-- Print Instructions -->
    <div class="print-instructions">
      <h3>üìÑ How to Save as PDF</h3>
      <p><strong>Step 1:</strong> Click the "Print to PDF" button above</p>
      <p><strong>Step 2:</strong> In the print dialog, select "Save as PDF" or "Microsoft Print to PDF"</p>
      <p><strong>Step 3:</strong> Choose your save location and click Save</p>
      <p><em>üí° Tip: Use Landscape orientation for best results</em></p>
    </div>
    
    <!-- Header -->
    <div class="header">
      <h1>üèì 2025 Tournament Calendar</h1>
      <p>Malaysia Pickleball Association</p>
      <p>Official Tournament Schedule for <%= new Date().getFullYear() %></p>
      
      <div class="stats">
        <div class="stat-item">
          <div class="stat-number"><%= tournaments.length %></div>
          <div class="stat-label">Total Tournaments</div>
        </div>
        <div class="stat-item">
          <div class="stat-number">4</div>
          <div class="stat-label">Tournament Types</div>
        </div>
        <div class="stat-item">
          <div class="stat-number">12</div>
          <div class="stat-label">Months Coverage</div>
        </div>
      </div>
    </div>

    <!-- Legend -->
    <div class="legend">
      <h3>Tournament Categories</h3>
      <div class="legend-items">
        <div class="legend-item">
          <div class="legend-color green"></div>
          <span>Local Tournaments</span>
        </div>
        <div class="legend-item">
          <div class="legend-color red"></div>
          <span>State Tournaments</span>
        </div>
        <div class="legend-item">
          <div class="legend-color blue"></div>
          <span>National Tournaments</span>
        </div>

      </div>
    </div>

    <!-- Calendar Table -->
    <table class="calendar-table">
      <thead>
        <tr>
          <th rowspan="2" class="tournament-name" style="background: #667eea !important; color: white !important;">
            Tournament
          </th>
          <% const months = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December']; %>
          <% months.forEach(month => { %>
            <th class="month-header" colspan="4"><%= month %></th>
          <% }); %>
        </tr>
        <tr>
          <% for (let i = 0; i < months.length; i++) { %>
            <th class="quarter-header">Q1</th>
            <th class="quarter-header">Q2</th>
            <th class="quarter-header">Q3</th>
            <th class="quarter-header">Q4</th>
          <% } %>
        </tr>
      </thead>
      <tbody>
        <% 

          
          // Transform tournaments for display
          const tournamentData = tournaments.map(t => {
            const schedule = Array(12).fill().map(() => []);
            if (t.startDate) {
              const start = new Date(t.startDate);
              
              // Only show dot on start date, not the entire duration
              const month = start.getMonth();
              const day = start.getDate();
              
              // Better quarter calculation based on actual weeks
              let quarter = Math.ceil(day / 7.75); // More accurate quarter division
              if (quarter > 4) quarter = 4; // Cap at quarter 4
              
              if (!schedule[month]) schedule[month] = [];
              if (!schedule[month].includes(quarter)) {
                schedule[month].push(quarter);
              }
            }
            return {
              name: t.name,
              type: t.type,
              startDate: t.startDate,
              endDate: t.endDate,
              color: `filled-${t.color}`,
              schedule
            };
          });
        %>
        
        <% if (tournamentData && tournamentData.length) { %>
          <% tournamentData.forEach((t, index) => { %>
            <tr>
              <td class="tournament-name" title="<%= t.name %>">
                <div class="font-bold text-sm"><%= t.name %></div>
                <div class="text-xs text-gray-600 mt-1">
                  <% if (t.startDate) { %>
                    <% const startDate = new Date(t.startDate); %>
                    <% const endDate = t.endDate ? new Date(t.endDate) : null; %>
                    <% const startDay = startDate.getDate(); %>
                    <% const startMonth = startDate.toLocaleDateString('en-US', { month: 'short' }); %>
                    <% const startYear = startDate.getFullYear(); %>
                    <% if (endDate && endDate.getTime() !== startDate.getTime()) { %>
                      <% const endDay = endDate.getDate(); %>
                      <%= startDay %>-<%= endDay %> <%= startMonth %> <%= startYear %>
                    <% } else { %>
                      <%= startDay %> <%= startMonth %> <%= startYear %>
                    <% } %>
                  <% } else { %>
                    Date TBD
                  <% } %>
                </div>
              </td>
              <% for (let m = 0; m < months.length; m++) { %>
                <% for (let q = 1; q <= 4; q++) { %>
                  <% 
                    const hasEvent = t.schedule && t.schedule[m] && t.schedule[m].includes(q);
                    const cellClass = hasEvent ? t.color : '';
                  %>
                  <td class="calendar-cell <%= cellClass %>">
                    <% if (hasEvent) { %>
                      <div class="tournament-dot"></div>
                    <% } %>
                  </td>
                <% } %>
              <% } %>
            </tr>
          <% }) %>
        <% } else { %>
          <tr>
            <td colspan="49" style="padding: 20px; text-align: center; color: #666;">
              No tournaments scheduled for <%= new Date().getFullYear() %>
            </td>
          </tr>
        <% } %>
      </tbody>
    </table>

    <!-- Tournament List -->
    <div class="tournament-list">
      <h3>Tournament Details</h3>
      <% if (tournaments && tournaments.length) { %>
        <% tournaments.forEach(tournament => { %>
          <div class="tournament-item" style="display: block; padding: 15px 0; border-bottom: 1px solid #e5e7eb;">
            <div style="margin-bottom: 8px;">
              <div class="tournament-title" style="font-size: 16px; font-weight: bold; color: #1f2937; margin-bottom: 4px;">
                <%= tournament.name %>
              </div>
              <div class="tournament-type" style="font-size: 12px; color: #6b7280; text-transform: capitalize;">
                <%= tournament.type ? (tournament.type.charAt(0).toUpperCase() + tournament.type.slice(1)) : 'General' %> Tournament
              </div>
            </div>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 10px;">
              <!-- Left Column -->
              <div>
                <div style="margin-bottom: 8px;">
                  <strong style="font-size: 11px; color: #374151;">üìÖ Date:</strong>
                  <span style="font-size: 11px; color: #6b7280;">
                    <% if (tournament.startDate) { %>
                      <%= new Date(tournament.startDate).toLocaleDateString('en-GB', { 
                        day: 'numeric',
                        month: 'short',
                        year: 'numeric'
                      }) %>
                      <% if (tournament.endDate && tournament.endDate !== tournament.startDate) { %>
                        - <%= new Date(tournament.endDate).toLocaleDateString('en-GB', { 
                          day: 'numeric',
                          month: 'short',
                          year: 'numeric'
                        }) %>
                      <% } %>
                    <% } else { %>
                      TBD
                    <% } %>
                  </span>
                </div>
                
                <% if (tournament.venue) { %>
                <div style="margin-bottom: 8px;">
                  <strong style="font-size: 11px; color: #374151;">üèüÔ∏è Venue:</strong>
                  <span style="font-size: 11px; color: #6b7280;"><%= tournament.venue %></span>
                </div>
                <% } %>
                
                <% if (tournament.city) { %>
                <div style="margin-bottom: 8px;">
                  <strong style="font-size: 11px; color: #374151;">üèôÔ∏è City:</strong>
                  <span style="font-size: 11px; color: #6b7280;"><%= tournament.city %></span>
                </div>
                <% } %>
              </div>
              
              <!-- Right Column -->
              <div>
                <% if (tournament.organizer) { %>
                <div style="margin-bottom: 8px;">
                  <strong style="font-size: 11px; color: #374151;">üè¢ Organizer:</strong>
                  <span style="font-size: 11px; color: #6b7280;"><%= tournament.organizer %></span>
                </div>
                <% } %>
                
                <% if (tournament.personInCharge) { %>
                <div style="margin-bottom: 8px;">
                  <strong style="font-size: 11px; color: #374151;">üë§ Contact Person:</strong>
                  <span style="font-size: 11px; color: #6b7280;"><%= tournament.personInCharge %></span>
                </div>
                <% } %>
                
                <% if (tournament.phoneNumber) { %>
                <div style="margin-bottom: 8px;">
                  <strong style="font-size: 11px; color: #374151;">üìû Phone:</strong>
                  <span style="font-size: 11px; color: #6b7280;"><%= tournament.phoneNumber %></span>
                </div>
                <% } %>
              </div>
            </div>
          </div>
        <% }) %>
      <% } %>
    </div>

    <!-- Footer -->
    <div class="footer">
      <p>Generated on <%= new Date().toLocaleDateString('en-GB', { 
        weekday: 'long',
        year: 'numeric',
        month: 'long',
        day: 'numeric'
      }) %> at <%= new Date().toLocaleTimeString('en-GB', { 
        hour: '2-digit',
        minute: '2-digit'
      }) %></p>
      <p>Malaysia Pickleball Association | Official Tournament Calendar</p>
      <p>For updates and registration information, visit our official website</p>
    </div>
  </div>
</body>
</html> 